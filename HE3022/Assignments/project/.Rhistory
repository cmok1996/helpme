data(rivers)
rivers
sort(rivers)
n < - length(rivers)
n <- length(rivers)
mean(rivers<-300)"n"
mean(rivers<-300)n
mean(rivers<-300)'n
mean(rivers<-300)*n
mean(rivers<300)*n
mean(rivers<300)"n
rplot <- hist(rivers,breaks- "Sturges",freq-T,main-"River Lenghts",xTab-"miles")
rplot <- hist(rivers,breaks- "Sturges",freq-T,main-"River Lenghts",xlab-"miles")
rplot <- hist(rivers,breaks= "Sturges",freq-T,main-"River Lenghts",xlab-"miles")
rplot <- hist(rivers,breaks="Sturges",freq-T,main-"River Lenghts",xlab-"miles")
rplot <- hist(rivers,breaks="Sturges",freq-T,main="River Lengths",xlab="miles")
rplot <- hist(rivers,breaks="Sturges",freq-T,main="River Lengths",xlab="miles")
rplot <- hist(rivers,breaks="Sturges",freq=T,main="River Lengths",xlab="miles")
stemplot <- stem(rivers,scale=2)
stemplot <- stem(rivers,scale-2)
stemplot <- stem(rivers,scale-2)
n <- length(rivers)
stemplot <= stem(rivers,scale-2)
rplot <- hist(rivers,breaks="Sturges", freq-T,main="River Lengths", xlab="miles")
rplot <- hist(rivers, breaks="Sturges", freq-T, main="River Lengths", xlab="miles")
data(titanic)
data(titanic)
data(Titanic)
data(titanic)
data(rivers)
data(titanic)
data(rivers)
data(rivers)
data(Titanic)
x <- c(36,27,24,50,31,23,45,44,43,32,19,34,38,21,16)
y <- c(12,11,10,17,10,12,18,16,14,13,11,12,17,8,7)
lot(x,y,main="Scatter Plot Moisture/Humidity ",xlab="Relative Humidity (%)", ylab="Moisture (%)")
plot(x,y,main="Scatter Plot Moisture/Humidity ",xlab="Relative Humidity (%)", ylab="Moisture (%)")
data(titanic)
data(Titanic)
pie(Titanic(1,1:2,2,2),Radius=1,1)
pie("Titanic"(1,1:2,2,2),Radius=1,1)
library(MASS)
data(SP500)
5+5
plot(SP500)
acf(SP500)
plot(SP500, type="1")
plot(SP500, type='1')
plot(SP500, type = '1')
plot(SP500, type = 'l')
data(SP500)
x<-data(SP500)
x<-data("SP500")
x<-data(SP500)
library(MASS)
x<-data(SP500)
acf(SP500)
setwd("C:/Users/cmok1/Desktop/Course material/Y3S2/HE3022/Workbook")
install.packages("fpp2")
library(fpp2)
tute1 <- read.csv("C:/Users/cmok1/Desktop/Course material/Y3S2/HE3022/Workbook/tute1.csv")
autoplot(melsyd[,"Economy.Class"]) +
ggtitle("Economy class passengers: Melbourne-Sydney") +
xlab("Year") + ylab("Thousands")
head(melsyd)
head(a10)
autoplot(a10) +
ggtitle("Antidiabetic drug sales") +
ylab("$ million") + xlab("Year")
#some seasonality, upward trend
ggseasonplot(a10,year.labels=TRUE,year.labels.left=TRUE) +
ylab("$ million") + ggtitle("Seasonal plot: antidiabetic drug sales")
ggseasonplot(a10, polar=TRUE) + ylab("$ million") + ggtitle("Polar seasonal plot: antidiabetic drug sales")
ggsubseriesplot(a10) + ylab("$ million") +
ggtitle("Seasonal subseries plot: antidiabetic drug sales")
month.breaks <- cumsum(c(0,31,28,31,30,31,30,31,31,30,31,30,31)*4)
autoplot(elecdemand[,c(1,3)],facet=TRUE) +
xlab("Year:2014") + ylab("") +
ggtitle("Half-hourly electricity demand: Victoria, Australia") +
scale_x_continuous(breaks=2014+month.breaks/max(month.breaks),
minor_breaks=NULL,labels=c(month.abb,month.abb[1]))
head(elecdemand)
qplot(Temperature,Demand,data=as.data.frame(elecdemand)) + #need assign variable as datafram to plot
ylab("Demand (GW)") + xlab("Temperature (Celsius)")
months.breaks
month.breaks
autoplot(vn,facets=TRUE) +
ylab("Number of visitor nights each quarter")
head(vn)
max(month.breaks)
month.breaks <- cumsum(c(0,31,28,31,30,31,30,31,31,30,31,30,31)*48) #half-hour
autoplot(elecdemand[,c(1,3)],facet=TRUE) + #include facet=TRUE to have 2 different graphs plot according to scale
xlab("Year:2014") + ylab("") +
ggtitle("Half-hourly electricity demand: Victoria, Australia") +
scale_x_continuous(breaks=2014+month.breaks/max(month.breaks),
minor_breaks=NULL,labels=c(month.abb,month.abb[1]))
2014+month.breaks
2014+month.breaks/max(month.breaks)
month.breaks <- cumsum(c(0,31,28,31,30,31,30,31,31,30,31,30,31)*48) #half-hour
autoplot(elecdemand[,c(1,3)],facet=TRUE) + #include facet=TRUE to have 2 different graphs plot according to scale
xlab("Year:2014") + ylab("") +
ggtitle("Half-hourly electricity demand: Victoria, Australia") +
scale_x_continuous(breaks=2014+month.breaks/max(month.breaks)
library(fpp)
library(fpp)
install.packages("GGally")
autoplot(elecdemand[,c(1,3)],facet=TRUE) + #include facet=TRUE to have 2 different graphs plot according to scale
xlab("Year:2014") + ylab("") +
ggtitle("Half-hourly electricity demand: Victoria, Australia") +
scale_x_continuous(breaks=2014+month.breaks/max(mont
#vn %>% as.data.frame() %>% GGally: :ggpairs() #pipe operator, ggpairs, vn is avaialable in fpp package
beer2 <- window(ausbeer, start=1992, end=2006)
#vn %>% as.data.frame() %>% GGally: :ggpairs() #pipe operator, ggpairs, vn is avaialable in fpp package
beer2 <- window(ausbeer, start=1992, end=2006)
help("window")
lag.plot(beer2, lags=9, do.lines=FALSE)
ausbeer
head(ausbeer)
#if perfectly correlated, data points are along dashed line
#see the same correlation in lag4, lag8 - quarterly seasonality
acf(beer2)
#autocorrelation of odd lags is insignificant, significant autocorrelation for even lags
#positive correlation every 4 quarters, some form of seasonality
aelec <- window(elec, start=1980)
autoplot(aelec) + xlab("Year") + ylab("Gwh")
aelec
ggAcf(aelec, lag=40)
#to select model, we look at residual to ensure is white noise - all patterns have been extrated
set.seed(30); x <- ts(rnorm(50)); plot(x,main="White noise")
acf(x)
#Set training data from 1992 - 2007
beer2 <- window(ausbeer,start=1992,end=c(2007,4))
#plot some forecasts
autoplot(beer2) +
forecast::autoplayer(meanf(beer2,h=11)$mean,series="Mean")+
forecast::autoplayer(naive(beer2,h=11)$mean,series="Naive")+
forecast::autoplayer(snaive(beer2,h=11)$mean,series="Seasonal naive")
#plot some forecasts
autoplot(beer2) +
forecast::autolayer(meanf(beer2,h=11)$mean,series="Mean")+
forecast::autolayer(naive(beer2,h=11)$mean,series="Naive")+
forecast::autolayer(snaive(beer2,h=11)$mean,series="Seasonal naive")
#plot some forecasts
autoplot(beer2) + #autolayer allows overlap
forecast::autolayer(meanf(beer2,h=11)$mean,series="Mean")+ #mean
forecast::autolayer(naive(beer2,h=11)$mean,series="Naive")+ #last observation
forecast::autolayer(snaive(beer2,h=11)$mean,series="Seasonal naive")+ #last seasonal series
ggtitle("forecast for quarterly beer production") +
xlab("Year") + ylab("Megalitres") +
guides(colour=guide_legend(title="Forecast"))
# Plot some forecasts
autoplot(dj2) +
forecast::autolayer(meanf(dj2, h=42)$mean, series="Mean") +
forecast::autolayer(rwf(dj2, h=42)$mean, series="NaÃ¯ve") +
forecast::autolayer(rwf(dj2, drift=TRUE, h=42)$mean, series="Drift") +
ggtitle("Dow Jones Index (daily ending 15 Jul 94)") +
xlab("Day") + ylab("") +
guides(colour=guide_legend(title="Forecast"))
#Example 2
# Set training data to first 250 days
dj2 <- window(dj,end=250)
# Plot some forecasts
autoplot(dj2) +
forecast::autolayer(meanf(dj2, h=42)$mean, series="Mean") +
forecast::autolayer(rwf(dj2, h=42)$mean, series="NaÃ¯ve") +
forecast::autolayer(rwf(dj2, drift=TRUE, h=42)$mean, series="Drift") +
ggtitle("Dow Jones Index (daily ending 15 Jul 94)") +
xlab("Day") + ylab("") +
guides(colour=guide_legend(title="Forecast"))
# Plot some forecasts
autoplot(dj2) +
forecast::autolayer(meanf(dj2, h=42), series="Mean") +
forecast::autolayer(rwf(dj2, h=42)$mean, series="NaÃ¯ve") +
forecast::autolayer(rwf(dj2, drift=TRUE, h=42)$mean, series="Drift") +
ggtitle("Dow Jones Index (daily ending 15 Jul 94)") +
xlab("Day") + ylab("") +
guides(colour=guide_legend(title="Forecast"))
# Plot some forecasts
autoplot(dj2) +
forecast::autolayer(meanf(dj2, h=42)$mean, series="Mean") +
forecast::autolayer(rwf(dj2, h=42)$mean, series="NaÃ¯ve") +
forecast::autolayer(rwf(dj2, drift=TRUE, h=42)$mean, series="Drift") +
ggtitle("Dow Jones Index (daily ending 15 Jul 94)") +
xlab("Day") + ylab("") +
guides(colour=guide_legend(title="Forecast"))
#load packages
library(fpp2)
library(tseries)
library(GGally)
library(seasonal)
library(dplyr)
#Load data - data from 1985-01 to 2020-01
fnb <- read.csv("fnb_index_chained.csv", header=TRUE)
fnb <- ts(fnb[,2:6], start=c(1985,1), frequency=12)
#Load data - data from 1985-01 to 2020-01
fnb <- read.csv("fnb_index_chained.csv", header=TRUE)
setwd("C:/Users/cmok1/Desktop/Course material/Y3S2/HE3022/Assignments/project")
#Load data - data from 1985-01 to 2020-01
fnb <- read.csv("fnb_index_chained.csv", header=TRUE)
fnb <- ts(fnb[,2:6], start=c(1985,1), frequency=12)
#fnb_chained_sa <- read.csv("fnb_chained_sa.csv", header=TRUE)
tourism <- read.csv("tourism.csv", header=TRUE)
tourism_ts <- ts(log(tourism[,2]), start = c(1978,1), end = c(2020,2), frequency=12)
tourism_window <- window(tourism_ts, c(2005,1), c(2019,12))
population <- read.csv("ppn.csv", header=TRUE)
population["percentage change"] <- (population$Total.Population....Number./lag(population$Total.Population....Number.)-1)*100
population_ts <- ts(population[,2:3], 1950, 2019, frequency = 1)
population_window <- window(population_ts, 2005)
annual_ppn <- population_window[,2]
monthly_ppn <- rep(log(population_window[,1]), each=12)
monthly_rate <- rep(population["percentage change"], each=12)
ppn <- cbind(monthly_ppn, monthly_rate)
ppn <- ts(ppn, c(2005,1), c(2019,12), frequency=12)
fnb_train <- window(fnb, start = c(2005,1), end = c(2017,12))
tourism_train <- window(tourism_window, c(2005,1), c(2017,12))
population_train <- window(ppn, c(2005,1), c(2017,12))
fnb_test <- window(fnb, start = c(2018,1), end = c(2019,12))
tourism_test <- window(tourism_window, c(2018,1), c(2019,12))
population_test <- window(ppn, c(2018,1), c(2019,12))
df_train <- data.frame(fnb_train[,1], tourism_train, population_train[,2],)
df_train <- data.frame(fnb_train[,1], tourism_train, population_train[,2])
df_test <- data.frame(fnb_test[,1], tourism_test, population_test)
fit1 <- tslm(df_train[,1] ~ df_train[,2] + df_train[,3], na.rm=TRUE)
fit3 <- auto.arima(df_train[,1], xreg=cbind(df_train[,2], df_train[,3]))
View(df_train)
View(population_train)
View(population_train)
population_train <- window(ppn[,1:2], c(2005,1), c(2017,12))
View(fnb_train)
View(population_ts)
ppn <- ts(ppn[,1:2], c(2005,1), c(2019,12), frequency=12)
ppn <- ts(ppn[,1:2], c(2005,1), c(2019,12), frequency=12, na.rm=TRUE)
ppn <- ts(ppn[,1], c(2005,1), c(2019,12), frequency=12)
ppn <- cbind(monthly_ppn, monthly_rate)
ppn <- c(monthly_ppn, monthly_rate)
ppn <- data.frame(monthly_ppn, monthly_rate)
monthly_ppn <- rep(log(population_window[,1]), each=12)
monthly_rate <- rep(population["percentage change"], each=12)
population["percentage change"] <- (population$Total.Population....Number./lag(population$Total.Population....Number.)-1)*100
population_ts <- ts(population[,2:3], 1950, 2019, frequency = 1)
View(population_ts)
population_window <- window(population_ts, 2005)
tourism_ts <- ts(log(tourism[,2]), start = c(1978,1), end = c(2020,2), frequency=12)
tourism_ts <- ts(tourism[,2], start = c(1978,1), end = c(2020,2), frequency=12)
tourism_ts["growth rate"] <- diff(log(tourism_ts[,1]),1) * 100
tourism_ts["growth rate"] <- diff(log(tourism_ts[,1]),1)
?diff
library(tseries)
?diff
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts[,1],1)))
value <- c(1,2,3,4,5)
diff(value,1)
#load packages
library(fpp2)
library(tseries)
#fnb_chained_sa <- read.csv("fnb_chained_sa.csv", header=TRUE)
tourism <- read.csv("tourism.csv", header=TRUE)
tourism_ts <- ts(tourism[,2], start = c(1978,1), end = c(2020,2), frequency=12)
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts[,1],1)))
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts[,1]),1))
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts,1))
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts),1))
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts),1))
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(log(tourism_ts),12))
tourism_df <- cbind("Total" = tourism_ts[,1], "Growth rate" = diff(tourism_ts,1))
diff(value,1)
diff(log(tourism_ts),1)
tourism_df <- cbind("Total" = tourism_ts, "Growth rate" = diff(log(tourism_ts),1))
View(toruism_df)
View(tourism_df)
tourism_window <- window(tourism_df, c(2005,1), c(2019,12))
autoplot(tourism_window, facets=TRUE)
#take log for population
population <- read.csv("ppn.csv", header=TRUE)
#pct_change <- (population$Total.Population....Number./lag(population$Total.Population....Number.)-1)*100
population_ts <- ts(population[,2], 1950, 2019, frequency = 1)
population_window <- window(population_ts, 2005)
tourism_df <- cbind("Total" = tourism_ts, "log-total" = log(tourism_ts), "Growth rate" = diff(log(tourism_ts),1))
tourism_window <- window(tourism_df, c(2005,1), c(2019,12))
autoplot(tourism_window, facets=TRUE)
population_df_annual <- cbind("Total" = population_ts, "log-total" = log(population_ts), "Growth rate" = diff(log(population_ts),1))
population_df <- rep(population_df_annual, 12)
View(population_df)
population_df[,"Total"] <- rep(population_df_annual[,1], 12)
population_df["Total"] <- rep(population_df_annual[,1], 12)
remove(population_df)
population_df["Total"] <- rep(population_df_annual[,1], 12)
monthly_total <- rep(population_ts,12)
monthly_logtotal <- rep(log(population_ts),12)
monthly_rate <- rep(diff(log(population_ts),1),12)
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_lagtotal, "Growth rate" = monthly_rate)
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
population_window <- window(population_ts, 2005)
population_window <- window(population_df, 2005)
population_ts <- window(population_ts, 2005)
monthly_total <- rep(population_ts,12)
monthly_logtotal <- rep(log(population_ts),12)
monthly_rate <- rep(diff(log(population_ts),1),12)
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
monthly_total <- ts(rep(population_ts,12), c(2005,1), c(2019,12))
monthly_logtotal <- ts(rep(log(population_ts),12), c(2005,1), c(2019,12)
monthly_logtotal <- ts(rep(log(population_ts),12), c(2005,1), c(2019,12))
monthly_logtotal <- ts(rep(log(population_ts),12), c(2005,1), c(2019,12))
monthly_rate <- ts(rep(diff(log(population_ts),1),12), c(2005,1), c(2019,12))
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
autoplot(population_df, facets=TRUE)
View(population_df)
View(monthly_total)
#pct_change <- (population$Total.Population....Number./lag(population$Total.Population....Number.)-1)*100
population_ts <- ts(population[,2], 1950, 2019, frequency = 1)
population_ts <- window(population_ts, 2005)
monthly_total <- ts(rep(population_ts, each = 12), c(2005,1), c(2019,12))
monthly_logtotal <- ts(rep(log(population_ts), each = 12), c(2005,1), c(2019,12))
monthly_rate <- ts(rep(diff(log(population_ts),1), each= 12), c(2005,1), c(2019,12))
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
autoplot(population_df, facets=TRUE)
rep(population_ts, each=12)
monthly_total <- rep(population_ts, each = 12) %>% ts(c(2005,1), c(2019,12))
monthly_total <- rep(population_ts, each = 12)
monthly_total <- data.frame(rep(population_ts, each = 12))
monthly_total <- ts(monthly_total, c(2005,1), c(2019,12))
monthly_total <- ts(monthly_total, c(2005,1), c(2019,12), 12)
monthly_logtotal <- ts(rep(log(population_ts), each = 12), c(2005,1), c(2019,12), frequency=12)
monthly_rate <- ts(rep(diff(log(population_ts),1), each= 12), c(2005,1), c(2019,12), frequency=12)
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
autoplot(population_df, facets=TRUE)
monthly_total <- ts(monthly_total, c(2005,1), c(2019,12), 12)
monthly_total <- data.frame(rep(population_ts, each = 12))
monthly_total <- ts(monthly_total, c(2005,1), c(2019,12), 12)
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
autoplot(population_df, facets=TRUE)
monthly_total <- ts(rep(population_ts, each=12), c(2005,1), c(2019,12), 12)
monthly_logtotal <- ts(rep(log(population_ts), each = 12), c(2005,1), c(2019,12), frequency=12)
monthly_rate <- ts(rep(diff(log(population_ts),1), each= 12), c(2005,1), c(2019,12), frequency=12)
population_df <- cbind("Total" = monthly_total, "log-total" = monthly_logtotal, "Growth rate" = monthly_rate)
autoplot(population_df, facets=TRUE)
